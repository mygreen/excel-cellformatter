<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ja"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Token.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Excel-CellFormatter</a> &gt; <a href="index.source.html" class="el_package">com.github.mygreen.cellformatter.tokenizer</a> &gt; <span class="el_source">Token.java</span></div><h1>Token.java</h1><pre class="source lang-java linenums">package com.github.mygreen.cellformatter.tokenizer;


/**
 * Excelのセルの書式の基本的な構成要素を表現するトークン。
 * 
 * @author T.TSUCHIE
 *
 */
public abstract class Token {
    
    /**
     * 書式の区切り文字';'用の記号。
     */
<span class="fc" id="L15">    public static final Symbol SYMBOL_SEMI_COLON = new Symbol(&quot;;&quot;);</span>
    
    /**
     * 数値の桁数の区切り文字','の記号
     */
<span class="fc" id="L20">    public static final Symbol SYMBOL_COLON = new Symbol(&quot;,&quot;);</span>
    
    /**
     * 数値の百分率'%'の記号
     */
<span class="fc" id="L25">    public static final Symbol SYMBOL_PERCENT = new Symbol(&quot;%&quot;);</span>
    
    /**
     * 数値の分数'/'の記号
     */
<span class="fc" id="L30">    public static final Symbol SYMBOL_SLASH = new Symbol(&quot;/&quot;);</span>
    
    /**
     * 小数の区切り'.'の記号
     */
<span class="fc" id="L35">    public static final Symbol SYMBOL_DOT = new Symbol(&quot;.&quot;);</span>
    
    /**
     * テキストのマーカー'@'用の記号。
     */
<span class="fc" id="L40">    public static final Symbol SYMBOL_AT_MARK = new Symbol(&quot;@&quot;);</span>
    
    /**
     * エスケープ文字（バックスペース\\）
     */
    public static final String STR_ESCAPE_BACKSPACE = &quot;\\&quot;;
    
    /**
     * エスケープ文字（クエスチョン!）
     */
    public static final String STR_ESCAPE_QUESTION = &quot;!&quot;;
    
    /**
     * エスケープ文字の配列
     */
<span class="fc" id="L55">    public static final String[] STR_ESCAPES = {STR_ESCAPE_BACKSPACE, STR_ESCAPE_QUESTION};</span>
    
    /**
     * トークンの文字列。
     */
    private final String value;
    
<span class="fc" id="L62">    public Token(final String value) {</span>
<span class="fc" id="L63">        this.value = value;</span>
<span class="fc" id="L64">    }</span>
    
    public static Word word(final String token) {
<span class="fc" id="L67">        return new Word(token);</span>
    }
    
    public static EscapedChar escapedChar(final String token) {
<span class="fc" id="L71">        return new EscapedChar(token);</span>
    }
    
    public static Condition condition(final String token) {
<span class="fc" id="L75">        return new Condition(token);</span>
    }
    
    public static Underscore underscore(final String token) {
<span class="fc" id="L79">        return new Underscore(token);</span>
    }
    
    public static Asterisk asterisk(final String token) {
<span class="fc" id="L83">        return new Asterisk(token);</span>
    }
    
    public static Factor factor(final String token) {
<span class="fc" id="L87">        return new Factor(token);</span>
    }
    
    public static Formatter formatter(final String token) {
<span class="fc" id="L91">        return new Formatter(token);</span>
    }
    
    public static Digits digits(final String token) {
<span class="fc" id="L95">        return new Digits(token);</span>
    }
    
    public Word asWord() {
<span class="fc" id="L99">        return (Word) this;</span>
    }
    
    public Symbol asSymbol() {
<span class="fc" id="L103">        return (Symbol) this;</span>
    }
    
    public EscapedChar asEscapedChar() {
<span class="fc" id="L107">        return (EscapedChar) this;</span>
    }
    
    public Condition asCondition() {
<span class="fc" id="L111">        return (Condition) this;</span>
    }
    
    public Underscore asUnderscore() {
<span class="fc" id="L115">        return (Underscore) this;</span>
    }
    
    public Asterisk asAsterisk() {
<span class="fc" id="L119">        return (Asterisk) this;</span>
    }
    
    public Factor asFactor() {
<span class="fc" id="L123">        return (Factor) this;</span>
    }
    
    public Formatter asFormatter() {
<span class="fc" id="L127">        return (Formatter) this;</span>
    }
    
    public Digits asDigits() {
<span class="fc" id="L131">        return (Digits) this;</span>
    }
    
    @Override
    public String toString() {
<span class="nc" id="L136">        return getValue();</span>
    }
    
    /**
     * トークンの値を取得する。
     * @return
     */
    public String getValue() {
<span class="fc" id="L144">        return value;</span>
    }
    
    /**
     * ダブルクウォート'&quot;'で囲まれた文字列。
     *
     */
    public static class Word extends Token {
        
        public Word(final String value) {
<span class="fc" id="L154">            super(value);</span>
<span class="fc" id="L155">        }</span>
        
        /**
         * ダブルクウォート'&quot;'を除いたテキストの値を取得する。
         * @return
         */
        public String getWord() {
<span class="fc" id="L162">            int length = getValue().length();</span>
<span class="fc" id="L163">            return getValue().substring(1, length-1);</span>
            
        }
        
    }
    
    /**
     * 書式用の記号。
     *
     */
    public static class Symbol extends Token {
        
        public Symbol(final String value) {
<span class="fc" id="L176">            super(value);</span>
<span class="fc" id="L177">        }</span>
    }
    
    /**
     * エスケープされた文字。
     *
     */
    public static class EscapedChar extends Token {
        
        public EscapedChar(final String value) {
<span class="fc" id="L187">            super(value);</span>
<span class="fc" id="L188">        }</span>
        
        /**
         * エスケープ文字'\'を除いた文字を取得する。
         * @return
         */
        public String getChar() {
<span class="fc" id="L195">            return getValue().substring(1);</span>
        }
    }
    
    /**
     * 括弧で囲まれた条件の書式'[condition]'。
     *
     */
    public static class Condition extends Token {
        
        public Condition(final String value) {
<span class="fc" id="L206">            super(value);</span>
<span class="fc" id="L207">        }</span>
        
        /**
         * 括弧を除いた条件の値の取得。
         * @return
         */
        public String getCondition() {
<span class="fc" id="L214">            int length = getValue().length();</span>
<span class="fc" id="L215">            return getValue().substring(1, length-1);</span>
        }
        
    }
    
    /**
     * アンダースコア'_'とそれに続く次の文字。
     */
    public static class Underscore extends Token {
        
        public Underscore(final String value) {
<span class="fc" id="L226">            super(value);</span>
<span class="fc" id="L227">        }</span>
        
        /**
         * アンダースコアに付随する次の文字の取得
         * @return
         */
        public String getAttachedValue() {
<span class="nc" id="L234">            return getValue().substring(1);</span>
        }
        
    }
    
    /**
     * アスタリスク'*'とそれに続く次の文字。
     */
    public static class Asterisk extends Token {
        
        public Asterisk(final String value) {
<span class="fc" id="L245">            super(value);</span>
<span class="fc" id="L246">        }</span>
        
        /**
         * アスタリスクに付随する次の文字の取得
         * @return
         */
        public String getAttachedValue() {
<span class="nc" id="L253">            return getValue().substring(1);</span>
        }
        
    }
    
    /**
     * 書式の因子となるものを構成するもの。
     * ・日付などの'yyyy'や数値の'##'など。
     */
    public static class Factor extends Token {
        
        public Factor(String value) {
<span class="fc" id="L265">            super(value);</span>
<span class="fc" id="L266">        }</span>
        
    }
    
    /**
     * 書式のフォーマットの最小単位。
     * ・各書式ごとに解析して、{@link Factor}をさらに分解したもの。
     *
     */
    public static class Formatter extends Token {
        
        public Formatter(String value) {
<span class="fc" id="L278">            super(value);</span>
<span class="fc" id="L279">        }</span>
        
    }
    
    /**
     * 整数の数値
     * ・各書式ごとに解析して、{@link Factor}をさらに分解したもの。
     *
     */
    public static class Digits extends Token {
        
        public Digits(String value) {
<span class="fc" id="L291">            super(value);</span>
            
<span class="fc" id="L293">        }</span>
        
        /**
         * 整数に変換した値
         * @return
         */
        public int intValue() {
<span class="fc" id="L300">            return Integer.valueOf(getValue());</span>
        }
        
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.8.201612092310</span></div></body></html>