<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ja"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NumberFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Excel-CellFormatter</a> &gt; <a href="index.source.html" class="el_package">com.github.mygreen.cellformatter.number</a> &gt; <span class="el_source">NumberFactory.java</span></div><h1>NumberFactory.java</h1><pre class="source lang-java linenums">package com.github.mygreen.cellformatter.number;


/**
 * 数値オブジェクトのファクトリクラス。
 *
 * @version 0.10
 * @author T.TSUCHIE
 *
 */
<span class="fc" id="L11">public abstract class NumberFactory {</span>

    /**
     * 何も加工をしない数値のファクトリクラスの取得。
     * @return
     */
    public static NumberFactory nativeNumber() {
<span class="fc" id="L18">        return new NumberFactory() {</span>

            @Override
            public FormattedNumber create(double value) {
<span class="fc" id="L22">                return new NativeNumber(value);</span>
            }
        };
    }

    /**
     * 小数のファクトリクラスの取得
     * @param scale 小数の精度（桁数）。
     * @param useSeparator 区切り文字があるかどうか。
     * @param permilles 千分率の次数。ゼロと指定した場合は、{@code 1000^0}の意味。
     * @return {@link DecimalNumberFactory}のインスタンス。
     */
    public static DecimalNumberFactory decimalNumber(int scale, boolean useSeparator, final int permilles) {
<span class="fc" id="L35">        return new DecimalNumberFactory(scale, useSeparator, permilles);</span>
    }

    /**
     * パーセントのファクトリクラスの取得
     * @param scale 小数の精度（桁数）。
     * @param useSeparator 区切り文字があるかどうか。
     * @param permilles 千分率の次数。ゼロと指定した場合は、{@code 1000^0}の意味。
     * @return {@link PercentNumberFactory}のインスタンス。
     */
    public static PercentNumberFactory percentNumber(int scale, boolean useSeparator, final int permilles) {
<span class="fc" id="L46">        return new PercentNumberFactory(scale, useSeparator, permilles);</span>
    }

    /**
     * 指数のファクトリクラスの取得
     * @param scale 小数の精度（桁数）。
     * @param useSeparator 区切り文字があるかどうか。
     * @return {@link ExponentNumberFactory}のインスタンス。
     */
    public static ExponentNumberFactory exponentNumber(int scale, boolean useSeparator) {
<span class="fc" id="L56">        return new ExponentNumberFactory(scale, useSeparator);</span>
    }

    /**
     * 分数のファクトリクラスの取得
     * @param denominator 分母の値
     * @param exactDenom 分母を直接指定かどうか
     * @param wholeType 帯分数形式かどうか
     * @return {@link FractionNumberFactory}のインスタンス。
     */
    public static FractionNumberFactory fractionNumber(final int denominator,
            final boolean exactDenom, final boolean wholeType) {
<span class="fc" id="L68">        return new FractionNumberFactory(denominator, exactDenom, wholeType);</span>
    }

    /**
     * 数値オブジェクトのインスタンスを取得する。
     * @param value 変換元数値。
     * @return 組み立てた数値オブジェクト。
     */
    public abstract FormattedNumber create(double value);

    /**
     * 整数、小数の数値として作成するクラス。
     *
     */
    public static class DecimalNumberFactory extends NumberFactory {

        private int scale;

        private boolean useSeparator;

        private int permilles;

<span class="fc" id="L90">        public DecimalNumberFactory(final int scale, final boolean useSeparator, final int permilles) {</span>
<span class="fc" id="L91">            this.scale = scale;</span>
<span class="fc" id="L92">            this.useSeparator = useSeparator;</span>
<span class="fc" id="L93">            this.permilles = permilles;</span>
<span class="fc" id="L94">        }</span>

        @Override
        public FormattedNumber create(double value) {
<span class="fc" id="L98">            FormattedNumber number = new DecimalNumber(value, scale, permilles);</span>
<span class="fc" id="L99">            number.setUseSeparator(useSeparator);</span>
<span class="fc" id="L100">            return number;</span>
        }

    }

    /**
     * 指数として数値を作成するクラス。
     *
     */
    public static class ExponentNumberFactory extends NumberFactory {

        private int scale;

        private boolean useSeparator;

<span class="fc" id="L115">        public ExponentNumberFactory(final int scale, final boolean useSeparator) {</span>
<span class="fc" id="L116">            this.scale = scale;</span>
<span class="fc" id="L117">            this.useSeparator = useSeparator;</span>
<span class="fc" id="L118">        }</span>

        @Override
        public FormattedNumber create(double value) {
<span class="fc" id="L122">            FormattedNumber number = new ExponentNumber(value, scale);</span>
<span class="fc" id="L123">            number.setUseSeparator(useSeparator);</span>
<span class="fc" id="L124">            return number;</span>
        }

    }

    /**
     * パーセントとして数値を作成するクラス。
     *
     */
    public static class PercentNumberFactory extends NumberFactory {

        private int scale;

        private boolean useSeparator;

        private int permilles;

<span class="fc" id="L141">        public PercentNumberFactory(final int scale, final boolean useSeparator, final int permilles) {</span>
<span class="fc" id="L142">            this.scale = scale;</span>
<span class="fc" id="L143">            this.useSeparator = useSeparator;</span>
<span class="fc" id="L144">            this.permilles = permilles;</span>
<span class="fc" id="L145">        }</span>

        @Override
        public FormattedNumber create(double value) {
<span class="fc" id="L149">            FormattedNumber number = new PercentNumber(value, scale, permilles);</span>
<span class="fc" id="L150">            number.setUseSeparator(useSeparator);</span>
<span class="fc" id="L151">            return number;</span>
        }

    }

    /**
     * 分数として数値を作成するクラス
     *
     */
    public static class FractionNumberFactory extends NumberFactory {

        /** 分母の値 */
        private int denominator;

        /** 分母を直接指定かどうか */
        private boolean exactDenom;

        /** 帯分数形式かどうか */
        private boolean wholeType;

<span class="fc" id="L171">        public FractionNumberFactory(final int denominator, final boolean exactDenom, final boolean wholeType) {</span>
<span class="fc" id="L172">            this.denominator = denominator;</span>
<span class="fc" id="L173">            this.exactDenom = exactDenom;</span>
<span class="fc" id="L174">            this.wholeType = wholeType;</span>
<span class="fc" id="L175">        }</span>

        @Override
        public FormattedNumber create(double value) {

            FractionNumber number;
<span class="fc bfc" id="L181" title="All 2 branches covered.">            if(exactDenom) {</span>
<span class="fc" id="L182">                number = FractionNumber.createExactDenominator(value, denominator, wholeType);</span>
            } else {
<span class="fc" id="L184">                number = FractionNumber.createMaxDenominator(value, denominator, wholeType);</span>
            }

<span class="fc" id="L187">            return number;</span>
        }



    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>