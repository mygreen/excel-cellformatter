<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ja"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CellFormatResult.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Excel-CellFormatter</a> &gt; <a href="index.source.html" class="el_package">com.github.mygreen.cellformatter</a> &gt; <span class="el_source">CellFormatResult.java</span></div><h1>CellFormatResult.java</h1><pre class="source lang-java linenums">package com.github.mygreen.cellformatter;

import java.util.Date;
import java.util.TimeZone;

import com.github.mygreen.cellformatter.lang.MSColor;


/**
 * フォーマット結果を保持するクラス。
 * &lt;p&gt;条件に色が付与されている場合などの情報を保持する。
 * 
 * @version 0.6
 * @author T.TSUCHIE
 *
 */
<span class="fc" id="L17">public class CellFormatResult {</span>
    
    /**
     * フォーマットする際に使用した値
     */
    private Object value;
    
    /**
     * フォーマット後の値
     */
    private String text;
    
    /**
     * フォーマット後の色。nullの場合がある。
     */
    private MSColor textColor;
    
    /**
     * 一致したExcelのセクションの書式。
     */
    private String sectionPattern;
    
    /**
     * フォーマットした際のセルの種類
     */
    private FormatCellType cellType;
    
    /**
     * フォーマット対象の値を取得する。
     * &lt;p&gt;具体的に値を取得する際には、キャストして利用する。
     * @return フォーマット対象の値。
     */
    public Object getValue() {
<span class="nc" id="L50">        return value;</span>
    }
    
    /**
     * フォーマット対象の値をdouble型として取得する。
     * @return 数値の値を返す。{@link #isNumber()}の値が{@literal true}の時に値が取得可能。
     * @throws ClassCastException 書式が一致しない場合
     */
    public double getValueAsDoulbe() {
<span class="fc" id="L59">        return (double) value;</span>
    }
    
    /**
     * フォーマット対象の値を日時型として取得する。
     * @return タイムゾーンが考慮された日時です。タイムゾーンはデフォルトです。
     *         {@link #isDate()}の値が{@literal true}の時に値が取得可能。
     * @throws ClassCastException 書式が一致しない場合
     */
    public Date getValueAsDate() {
<span class="fc" id="L69">        return getValueAsDate(null);</span>
    }
    
    /**
     * タイムゾーンを指定して、フォーマット対象の値を日時型として取得する。
     * @since 0.6
     * @param tz タイムゾーン。値がnullの場合は、デフォルトを使用します。
     * @return タイムゾーンを考慮した日時オブジェクト。
     *          {@link #isDate()}の値が{@literal true}の時に値が取得可能。
     * @throws ClassCastException 書式が一致しない場合
     */
    public Date getValueAsDate(final TimeZone tz) {
<span class="fc" id="L81">        long time = ((Date) value).getTime();</span>
        long offset;
<span class="pc bpc" id="L83" title="1 of 2 branches missed.">        if(tz == null) {</span>
<span class="fc" id="L84">            offset = TimeZone.getDefault().getRawOffset();</span>
        } else {
<span class="nc" id="L86">            offset = tz.getRawOffset();</span>
        }
        
<span class="fc" id="L89">        return new Date(time - offset);</span>
    }
    
    /**
     * フォーマット対象の値を文字列型として取得する。
     * @return 文字列の値。{@link #isText()}の値が{@literal true}の時に値が取得可能。
     * @throws ClassCastException 書式が一致しない場合
     */
    public String getValueAsString() {
<span class="fc" id="L98">        return (String) value;</span>
    }
    
    /**
     * フォーマット対象の値をブール型として取得する。
     * @return {@link #isBoolean()}の値が{@literal true}の時に値が取得可能。
     * @throws ClassCastException 書式が一致しない場合
     */
    public boolean getValueAsBoolean() {
<span class="fc" id="L107">        return (boolean) value;</span>
    }
    
    /**
     * 値がブランクかどうか。
     * @return true:空。
     */
    public boolean isBlank() {
<span class="nc bnc" id="L115" title="All 2 branches missed.">        return getCellType() == FormatCellType.Blank;</span>
    }
    
    /**
     * 値がブール値かどうか
     * @return true：ブール型の場合
     */
    public boolean isBoolean() {
<span class="nc bnc" id="L123" title="All 2 branches missed.">        return getCellType() == FormatCellType.Boolean;</span>
    }
    
    /**
     * 値が日付型かどうか。
     * @return true:日時型の場合。
     */
    public boolean isDate() {
<span class="nc bnc" id="L131" title="All 2 branches missed.">        return getCellType() == FormatCellType.Date;</span>
    }
    
    /**
     * 値が数値型かどうか。
     * @return true:数値型の場合。
     */
    public boolean isNumber() {
<span class="nc bnc" id="L139" title="All 2 branches missed.">        return getCellType() == FormatCellType.Number;</span>
    }
    
    /**
     * 値が文字列型かどうか。
     * @return true:文字列型の場合。
     */
    public boolean isText() {
<span class="nc bnc" id="L147" title="All 2 branches missed.">        return getCellType() == FormatCellType.Text;</span>
    }
    
    /**
     * 値がエラー型かどうか。
     * @return true:エラーの場合。
     */
    public boolean isError() {
<span class="nc bnc" id="L155" title="All 2 branches missed.">        return getCellType() == FormatCellType.Error;</span>
    }
    
    /**
     * フォーマット対象の値を設定する。
     * @param value 値。
     */
    public void setValue(Object value) {
<span class="fc" id="L163">        this.value = value;</span>
<span class="fc" id="L164">    }</span>
    
    /**
     * 文字色を取得する。
     * @return 書式に色が適用されていない場合は、nullを返す。
     */
    public MSColor getTextColor() {
<span class="fc" id="L171">        return textColor;</span>
    }
    
    /**
     * 書式の文字色を設定する。
     * @param textColor 文字色。
     */
    public void setTextColor(MSColor textColor) {
<span class="fc" id="L179">        this.textColor = textColor;</span>
<span class="fc" id="L180">    }</span>
    
    /**
     * フォーマットした文字列を取得する
     * @return フォーマットした文字列。
     */
    public String getText() {
<span class="fc" id="L187">        return text;</span>
    }
    
    /**
     * フォーマットした文字列を設定する
     * @param text
     */
    public void setText(String text) {
<span class="fc" id="L195">        this.text = text;</span>
<span class="fc" id="L196">    }</span>
    
    /**
     * フォーマットの際、一致した書式内のセクションの書式を返す。
     * @return 一致したセクションの書式。
     */
    public String getSectionPattern() {
<span class="fc" id="L203">        return sectionPattern;</span>
    }
    
    /**
     * フォーマットの際、一致した書式内のセクションの書式を設定する
     * @param sectionPattern 一致したセクションの書式。
     */
    public void setSectionPattern(String sectionPattern) {
<span class="fc" id="L211">        this.sectionPattern = sectionPattern;</span>
<span class="fc" id="L212">    }</span>
    
    
    /**
     * セルの種類を取得する
     * &lt;p&gt;各メソッド{@link #isText()}などのisXXX()メソッドの判定に利用する。
     * @return フォーマットした結果のセルの種類。
     */
    public FormatCellType getCellType() {
<span class="fc" id="L221">        return cellType;</span>
    }
    
    /**
     * セルの種類を設定する。
     * @param cellType
     */
    public void setCellType(FormatCellType cellType) {
<span class="fc" id="L229">        this.cellType = cellType;</span>
<span class="fc" id="L230">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>