------------------------------------------------
エラーのセルについて
------------------------------------------------

Excelの計算結果などによって、エラー値が表示されます。

エラー値は数種類あり、ライブラリではコード値から判断します。


.. list-table:: Excelのエラー値の一覧
   :widths: 15 15 10 60
   :header-rows: 1

   * - | エラーコード
       | （10進数）
     - | エラーコード
       | （16進数）
     - 表示
     - 説明
     
   * - 0
     - 0
     - ``#NULL!``
     - | 正しくない参照演算子または正しくないセル参照を使っている場合に表示されます。
       | 例 ``=SUM(A1:A3 C1:C3)`` 

   * - 7
     - 7
     - ``#DIV/0!``
     - | 数式や関数が0（ゼロ）または空白のセルで割られている場合に表示されます。
       | 例 ``=200/0`` 

   * - 15
     - 15
     - ``#VALUE!``
     - | 関数の引数の形式が間違っている場合に表示されます。
       | 例 ``=MAX("Dekiru")`` 

   * - 23
     - 17
     - ``#REF!``
     - | 数式内で無効なセルが参照されている
       | 例 ``=INT(A1)`` とセルA1を移動または削除してしまった場合に表示されます。

   * - 29
     - 1d
     - ``#NAME?``
     - | Excelの関数では利用できない名前が使用されている場合に表示されます。
       | 例 ``=HEIKIN(A1:C1)`` 

   * - 36
     - 24
     - ``#NUM!``
     - | 数式または関数の数値が不適切な場合に表示されます。
       | 例 ``=SMALL(A1:A3,C1)`` と入力して第2引数の値を数値以外のセルを指定した場合に表示されます。

   * - 42
     - 2a
     - ``#N/A``
     - | 計算や処理の対象となるデータがない、または正当な結果が得られない場合に表示されます。
       | 例 ``=MODE(10,20,30,40)`` 


.. warning:: Apache POIでエラー値を取得する場合の注意事項。
   
   POIでエラー値が正しく取得できない場合があります。
   
   1. ファイルの形式がxls(HSSF)の場合、全て「#VALUE!」となります。ただし、ファイルの形式がxlsx(XSSF)だと各種類が取得できます。
      
      * xlsx(XSSF)形式の場合でも場合によっては異なるコード値となります。
      
   2. 関数「=DATE(50000,1,1)」はExcelでは「#NUM!」と表示され計算できないが、POIの場合は正常に計算ができます。
      
      * これは、Javaの日付の表示範囲がExcelよりも広いため。
   

