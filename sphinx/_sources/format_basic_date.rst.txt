
----------------------------
日時用の書式記号
----------------------------

Excelの表示形式で分類すれば、「日付」「時刻」に分けられます。

^^^^^^^^^^^^^^^^^^^^^^^^^
日付の書式
^^^^^^^^^^^^^^^^^^^^^^^^^

.. list-table:: 日付の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - yy
     - | 西暦の下2桁を表示します。10以下の場合、0埋めします。
     - | yy
     - | 2001/1/3 -> 01
       | 1998/10/15 -> 98
   
   * - yyyy
     - | 西暦を4桁で表示します。
       | ただし、1900年以前は、Excel上では日付として表現できないため999年以前のゼロ埋めなどは実質ありません。
       | Excelの設定により、1904年以前が表現できない場合もあります。
     - | yyyy
     - | 2001/1/3 -> 2001
       | 1998/10/15 -> 1998
   
   * - m
     - | 月を表示します。
       | ただし、時間の単位「分」を表現する「m」と区別するため、書式の前に時間を表現する記号「h」か、
         書式の後に秒を表現する「s」がある場合は、「分」と判断します。
     - | m
     - | 2001/1/3 -> 1
       | 1998/10/15 -> 10
   
   * - mm
     - | 月を表示します。
       | ただし、1 桁の月には 0 をつけて 2 桁で表示します。
     - | mm
     - | 2001/1/3 -> 01
       | 1998/10/15 -> 10
       
   * - mmm
     - | 英語の月の頭文字 3 文字 (Jan～Dec) を表示します。
     - | mmm
     - | 2001/1/3 -> Jan
       | 1998/10/15 -> Oct
       
   * - mmmm
     - | 英語の月 (January～December) を表示します。
     - | mmmm
     - | 2001/1/3 -> January
       | 1998/10/15 -> October
   
   * - mmmmm
     - | 英語の月の頭文字 (J～D) で表示します。
       | ただし、頭文字が同じものから始まる月は複数あり、区別がつかないため注意してください。
       * 頭文字が *J* から始まる月は、「January（1月）」「June（6月）」「July（7月）」。
       * 頭文字が *M* から始まる月は、「March（3月）」「May（5月）」。
       * 頭文字が *A* から始まる月は、「April（4月）」「August（8月）」。
     - | mmmmm
     - | 2001/1/3 -> J
       | 1998/10/5 -> O
   
   * - d
     - | 日にちを表示します。
     - | d
     - | 2001/1/3 -> 3
       | 1998/10/15 -> 15

   * - dd
     - | 日にちを表示します。
       | ただし、1 桁の日にちには 0 をつけて 2 桁で表示します。
     - | dd
     - | 2001/1/3 -> 03
       | 1998/10/15 -> 15


.. list-table:: 曜日の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - ddd
     - | 英語の曜日の頭文字から 3 文字 (Sun～Sat) を表示します。
       | ただし、日本語ロケール用の条件 *[$-411]* を付与すると、「aaa」と同じ漢字の曜日の頭文字（日～土）を表示します。
     - | ddd
       |
       | [$-411]ddd
     - | 2001/1/3 -> Wed
       | 1998/10/15 -> Thu
       | 2001/1/3 -> 水
   
   * - dddd
     - | 英語の曜日 (Sunday～Saturday) を表示します。
       | ただし、日本語ロケール用の条件 *[$-411]* を付与すると、「aaaa」と同じ漢字の曜日（日曜日～土曜日）を表示します。
     - | ddd
       |
       | [$-411]dddd
     - | 2001/1/3 -> Wednesday
       | 1998/10/15 -> Thursday
       | 2001/1/3 -> 水曜日
   
   * - aaa
     - | 漢字で曜日の頭文字 (日～土) を表示します。
     - | aaa
     - | 2001/1/3 -> 水
       | 1998/10/15 -> 木
   
   * - aaaa
     - | 漢字で曜日 (日曜日～土曜日) を表示します。
     - | aaaa
     - | 2001/1/3 -> 水曜日
       | 1998/10/15 -> 木曜日
   


^^^^^^^^^^^^^^^^^^^^^^^^^
和暦の書式
^^^^^^^^^^^^^^^^^^^^^^^^^

日本語固有の書式記号が和暦の表現が可能です。

ただし、他の言語環境でExcelファイルを開いたときに表記が変わらないよう、日本語のロケール *[$-411]* を指定することをお薦めします。


.. list-table:: 和暦の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - g
     - | 元号をローマ字の頭文字で表示します。
     - | [$-411]g
     - | 2001/1/3 -> H
       | 1960/10/15 -> S
   
   * - gg
     - | 元号を漢字の頭文字で表示します。
       | （大(大正)、昭(昭和)、平(平成)など）
     - | [$-411]gg
     - | 2001/1/3 -> 平
       | 1960/10/15 -> 昭
   
   * - ggg
     - | 元号を漢字で表示します。
       | （大正、昭和、平成など）
     - | [$-411]ggg
     - | 2001/1/3 -> 平成
       | 1960/10/15 -> 昭和
       
   * - e
     - | 和暦年を表示します。通常は、書式記号 g と組み合わせて使用します。
     - | [$-411]e
       |
       | [$-411]ggge
     - | 1990/1/3 -> 2
       | 1960/10/15 -> 35
       | 1990/1/3 -> 平成2
       | 1960/10/15 -> 昭和35
   
   * - ee
     - | 和暦年を表示します。通常は、書式記号 g と組み合わせて使用します。
       | ただし、1桁の年は 0 をつけて 2 桁で表示します。
     - | [$-411]ee
       |
       | [$-411]gee
     - | 1990/1/3 -> 02
       | 1960/10/15 -> 35
       | 1990/1/3 -> H02
       | 1960/10/15 -> S35
       
   * - r
     - | 和暦年を表示します。「ee」と同じ意味です。
       | ただし、1桁の年は 0 をつけて 2 桁で表示します。
     - | [$-411]r
       |
     - | 1990/1/3 -> 02
       | 1960/10/15 -> 35
       
   * - rr
     - | 元号の漢字と和暦年を表示します。「gggee」と同じ意味です。
       | ただし、1桁の年は 0 をつけて 2 桁で表示します。
     - | [$-411]rr
       |
     - | 1990/1/3 -> 平成02
       | 1960/10/15 -> 昭和35


日本語で表記可能な元号は、Excelで表現可能な1900年以降の明治からとなります。
元号の始まりの年は、元年ではなく1年と表記されます。

.. list-table:: Excelで表記可能な元号
   :widths: 10 20 10 30 30
   :header-rows: 1
   
   * - 名称
     - 略称（ローマ字）
     - 略称
     - 開始日
     - 終了日
   
   * - 明治
     - M
     - 明
     - 1900/1/1（明治33年）
     - 1912/7/29（明治45年）
   
   * - 大正
     - T
     - 大
     - 1912/7/30
     - 1926/12/24（大正15年）

   * - 昭和
     - S
     - 昭
     - 1926/12/25
     - 1989/1/7（昭和64年）

   * - 平成
     - H
     - 平
     - 1989/1/8
     - －
     

.. note:: Excel内部の時間の保持の方法
   
   Excelは、日時は内部では数字型で保持しており、値が0の場合は **「1900年1月0日（1899年12月31日）」** を表します。
   
   そのため、値が負の場合となる1899年12月30日以前の明治32年は表現できません。
   
   また、明治5年12月2日(1872年12月31日)まで、旧暦の太陰太陽暦を採用していたため、
   西暦とはずれが発生し、独自に1900年以前を表現するのは複雑になります。
   
   さらに、 :doc:`Excelの設定 <format_other_startdate>` によっては、
   値が0の場合が **「1904年1月1日」** から始まるように変更できるため、明治時代以前を表記するのには注意が必要となる。
   

.. note:: 和暦の内部表現
   
   本ライブラリでは、和暦情報は、独自のプロパティファイル ``「era_ja.properties」`` で定義されています。 
   Java標準のJRE ``「lib/calendars.properties」`` のプロパティファイルは参照していません。
   

^^^^^^^^^^^^^^^^^^^^^^^^^
時刻の書式
^^^^^^^^^^^^^^^^^^^^^^^^^

.. list-table:: 時間・時刻の書式
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - h
     - | 時刻（0～23）を表示します。
     - | h
     - | 8:12:1 -> 8
       | 13:1:40 -> 13
   
   * - hh
     - | 1 桁の時刻には 0 を付けて時刻 (00～23) を表示します。 
     - | hh
     - | 8:12:1 -> 08
       | 13:1:40 -> 13
       
   * - m (※)
     - | 分 (0～59) を表示します。
     - | h:m
     - | 8:12:1 -> 8:12
       | 13:1:40 -> 13:1
       
   * - mm (※)
     - | 1 桁の分は、0 を付けて分 (00～59) を表示します。
     - | hh:mm
     - | 8:12:1 -> 08:12
       | 13:1:40 -> 13:01
       
   * - s
     - | 秒 (0～59) を表示します。
     - | s
     - | 8:12:1 -> 1
       | 13:1:40 -> 40

   * - ss
     - | 1 桁の秒は 0 を付けて秒 (00～59) を表示します。
     - | ss
     - | 8:12:1 -> 01
       | 13:1:40 -> 40
      
.. note:: 分の書式「m」「mm」の注意事項
   
   分を表す「m」「mm」 は、月を表現する「m」と区別するため、書式の前に時間を表現する記号「h」「hh」か、
   書式の後に秒を表現する「s」「ss」を設定する必要があります。
   さらに、時間経過を表現する「[h]」の書式が前にある場合も、分と判断します。
   分を表現する「m」は単体で使用すると月と認識されるため、注意が必要です。


.. list-table:: AM/PM（午前/午後）の書式
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例

   * - AM/PM または am/pm (※)
     - | 時間を12時間表示し、AMまたはPMを付けます。
       | 日本語ロケール用の条件 *[$-411]* を付与すると、漢字表記（午前または午後）で表示します。
     - | h AM/PM
       |
       | am/pm h
       |
       | [$-411]AM/PM h"時"
       | 
     - | 8:12:1 -> 8 AM
       | 13:1:40 -> 1 PM
       | 8:12:1 -> am 8
       | 13:1:40 -> pm 1
       | 8:12:1 -> 午前 8時
       | 13:1:40 -> 午後 1時
       
   * - A/P または a/p (※)
     - | 時間を12時間表示し、AまたはPを付けます。
       | 日本語ロケール用の条件 *[$-411]* を付与すると、漢字表記（午前または午後）で表示します。
     - | h A/P
       |
       | a/p h
       |
       | [$-411]A/P h"時"
       | 
     - | 8:12:1 -> 8 A
       | 13:1:40 -> 1 P
       | 8:12:1 -> a 8
       | 13:1:40 -> p 1
       | 8:12:1 -> 午前 8時
       | 13:1:40 -> 午後 1時

.. note:: 午前/午後の書式の注意事項
   
   午前/午後の書式「AM/PM 、am/pm 、A/P 、a/p」は、書式の前後など書式中のどこに定義してもかまいません。
   
   大文字・小文字は入力した通りに表示されるため、「Am/Pm」「aM/pM」などという設定もできます。


.. list-table:: 時間の経過の書式
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例

   * - [h] (※)
     - | 24時間を超える時間の合計を表示します。
     - | [h]:mm
       |
     - | 1900/01/00 8:12:1 -> 8:12
       | 1900/01/01 13:1:40 -> 37:01

   * - [mm] (※)
     - | 60 分を超える分の合計を表示します。
     - | [mm]:ss
       |
     - | 1900/01/00 0:12:1 -> 12:01
       | 1900/01/00 1:35:20 -> 95:20
       
   * - [ss] (※)
     - | 60 秒を超える秒の合計を表示します。
     - | [ss]
       |
     - | 1900/01/00 0:12:1 -> 721 
       | 1900/01/00 1:12:1 -> 4321 
       

.. note:: 時間経過の書式の注意事項
   
   時間経過の書式は、値が0であるExcelの基準日の *1899年12月31日（Excel表記上は1900年1月0日）からの経過時間* となります。
   ただし、 :doc:`Excelの設定 <format_other_startdate>` により、基準日が1904年1月1日と設定されている場合もあります。


