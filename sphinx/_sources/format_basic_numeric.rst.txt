----------------------------
数値用の書式記号
----------------------------

Excelの数値関連の書式は分類すれば、「数値」「通貨」「会計」「パーセンテージ」「分数」「指数」に分けられます。

これらの書式は、全て :doc:`共通の書式記号 <format_basic_common>` と数値用の書式記号から構成されています。

.. list-table:: 数値の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
   
   * - #
     - | 1桁の数字を示します。
       | # の数だけ桁数が指定され、その有効桁数しか表示されません。
       | また、余分な 0 も表示されません。
     - | ####.#
     - | 1234.56 -> 1234.5600
     
   * - 0（ゼロ）
     - | 1桁の数字を示すが、指定したゼロの桁数だけ常にゼロが表示されます。
     - | #.0000
     - | 1234.56 -> 1234.5600
   
   * - ?（クエスチョン）
     - | 固定幅フォントで数値の小数点を揃えるために、整数部と小数部の余分なゼロがスペースで表示されます。
       | ? は桁数の異なる複数の小数を揃えて表示する場合に使います。
     - | ???.???
     - | 123.456 -> 123.456
       | 123.4 -> 12.34 (スペース)
       | 12.3  -> 12.3  (2つのスペース)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
桁数区切り、千分率表示用の記号
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

数値の桁を3桁ごとに区切る場合に、カンマ（,） を書式記号「# ? 0」の間に記述します。
カンマは、6桁以上あっても、カンマは1つのみ記述すればよいです。


書式記号「# ? 0」の最後に、カンマ（,）を記述すると、1000で割った千分率表示になります。


.. list-table:: 桁数区切りの書式記号
   :widths: 15 40 15 30
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
   
   * - | ,（カンマ）
       | （桁数区切り）
     - | 数値の書式記号間に記述した場合は、1000単位の区切り記号として表示します。
     - | #,###
     - | 12000 -> 12,000
   
   * - | ,（カンマ）
       | （千分率表示）
     - | 数値の書式記号の最後に記述した場合は、数値を 1000で割って小数部を四捨五入する千分率で表示します。
       | カンマを複数個記述すると1000^(カンマの個数)で割った表示になります。
     - | #,
       | 0.0,,
     - | 12000 -> 12(1000で割った表示)
       | 12200000 -> 12.2(1000^2で割った表示)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
百分率（パーセント）表示
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. list-table:: 百分率（パーセント）の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
   
   * - %（パーセント）
     - | 数を百分率で表示するには、数の書式にパーセント記号（%）を追加します
     - | ###%
       | ###.00%
     - | 0.123 -> 12%
       | 2.456 -> 245.60%


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
指数表示
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. list-table:: 指数の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - E+ または e+
     - | 数を指数表示するには、数の書式に「E+」または「e+」を記述し、さらに指数の書式を「# ? 0」を使用し指定します。
       | 指数の符号は、正負に関わらず表示されます。
     - | 0.E+00
       | 0.0000e+00
     - | 0.1234 -> 1.E-01
       | 12345.6789 -> 1.2346e+04
   
   * - E- または e-
     - | 数を指数表示するには、数の書式に「E-」または「e-」を記述し、さらに指数の書式を「# ? 0」を使用し指定します。
       | 指数の符号は、負の場合のみ表示されます。
     - | 0.E-00
       | 0.0000e-00
     - | 0.1234 -> 1.E-01
       | 12345.6789 -> 1.2346e04


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
分数表示
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

分数の表示は、「# ? 0」をスラッシュ記号（/）で区切ります。

帯分数、仮分数の表示もできます。

.. list-table:: 分数の書式記号
   :widths: 15 40 20 25
   :header-rows: 1
   
   
   * - 書式記号
     - 説明
     - 使用例
     - 表示例
     
   * - /
     - | 数値のフォーマット用の書式を「# ? 0」をスラッシュ記号（/）で分割すると、分子と分母をできます。
       | 分母の値を接値を指定した場合、その分母の値で表示します。
       | 分母を「# ? 0」の書式を利用した表現した場合、その書式で表現可能値を分母の最大値として近似します。
       | 例えば、「??/???」の場合、分母は3桁のため「999」を最大として近似します。
       | さらに、分子の前に空白などで区切り書式「# ? 0」を記述すると、帯分数表示になります。
     - | ??/## （仮分数表示）
       | ###\\ ??/## (帯分数表示)
       | #\\ ?/8 （分母を直接指定）
     - | 3.25 -> 13/4
       | 3.25 -> 3 1/4
       | 0.25 -> 2/8

