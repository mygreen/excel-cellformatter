

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5. Excelの書式のその他の情報 &#8212; Excel-CellFormatter 0.11 ドキュメント</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/mycustom.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="_static/mytheme.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="6. リリースノート" href="release.html" />
    <link rel="prev" title="4. Excelの書式の基本について" href="format_basic.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="release.html" title="6. リリースノート"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="format_basic.html" title="4. Excelの書式の基本について"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Excel-CellFormatter 0.11 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div id="toc" class="sidebarRow">
<h3><a href="../index.html">関連リンク</a></h3>
<ul>
	<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">JavaDoc</a></li>
	<li class="toctree-l1"><a class="reference internal" href="https://github.com/mygreen/excel-cellformatter">GitHub</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../project-info.html">プロジェクト情報</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../project-reports.html">プロジェクトレポート</a></li>
</ul>

<h3><a href="index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="biginning.html">1. はじめに</a><ul>
<li class="toctree-l2"><a class="reference internal" href="biginning.html#id2">1.1. このライブラリの位置付け及び目的</a></li>
<li class="toctree-l2"><a class="reference internal" href="biginning.html#id3">1.2. 前提環境</a></li>
<li class="toctree-l2"><a class="reference internal" href="biginning.html#restriction">1.3. 制限事項</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howtouse.html">2. 基本的な使い方</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id2">2.1. ダウンロード</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#apaceh-poi">2.2. Apaceh POIの場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#jexcelapi">2.3. JExcelAPIの場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#java">2.4. Javaオブジェクトの場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="customize.html">3. カスタマイズ方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="customize.html#id2">3.1. キャッシュの制御</a></li>
<li class="toctree-l2"><a class="reference internal" href="customize.html#id5">3.2. フォーマッタの事前登録</a></li>
<li class="toctree-l2"><a class="reference internal" href="customize.html#id6">3.3. 元号の定義の変更</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="format_basic.html">4. Excelの書式の基本について</a><ul>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id1">4.1. 参考リンク</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id2">4.2. 表示形式の構造</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id6">4.3. 共通の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id7">4.4. 数値用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id12">4.5. 日時用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id16">4.6. 文字列用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id17">4.7. 条件式について</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id23">4.8. 他のオフィススイートの書式記号</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Excelの書式のその他の情報</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">5.1. 標準書式について</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">5.2. ファイル内部の日付の基準日の設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">5.3. ビルトインフォーマット（組み込み書式）について</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">5.4. エラーのセルについて</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id-lcid">5.5. ロケールID(LCID)の一覧</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">5.6. 漢数字／大字変換のアルゴリズム</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">6. リリースノート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-11-2019-04-03">6.1. ver.0.11 - 2019-04-03</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-10-2018-06-24">6.2. ver.0.10 - 2018-06-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-9-2-2017-09-22">6.3. ver.0.9.2 - 2017-09-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-9-1-2016-12-22">6.4. ver.0.9.1 - 2016-12-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-9-2016-12-19">6.5. ver.0.9 - 2016-12-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-8-3-2016-07-02">6.6. ver.0.8.3 - 2016-07-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-8-2-2016-05-21">6.7. ver.0.8.2 - 2016-05-21</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-8-1-2016-05-07">6.8. ver.0.8.1 - 2016-05-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-8-2016-04-29">6.9. ver.0.8 - 2016-04-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-7-2016-03-20">6.10. ver.0.7 - 2016-03-20</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-6-2016-02-20">6.11. ver.0.6 - 2016-02-20</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-5-1-2016-01-31">6.12. ver.0.5.1 - 2016-01-31</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-5-2016-01-16">6.13. ver.0.5 - 2016-01-16</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-4-2015-04-19">6.14. ver.0.4 - 2015-04-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-3-2015-04-11">6.15. ver.0.3 - 2015-04-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2015-04-04">6.16. ver.0.2 - 2015-04-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-1-2015-03-22">6.17. ver.0.1 - 2015-03-22</a></li>
</ul>
</li>
</ul>


</div>
  <h4>前のトピックへ</h4>
  <p class="topless"><a href="format_basic.html"
                        title="前の章へ">4. Excelの書式の基本について</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="release.html"
                        title="次の章へ">6. リリースノート</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/format_other.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="excel">
<h1>5. Excelの書式のその他の情報<a class="headerlink" href="#excel" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="id1">
<h2>5.1. 標準書式について<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>標準書式の場合、特に数値の場合、値によってフォーマットが変わります。</p>
<p><code class="docutils literal notranslate"><span class="pre">100,000,000,000</span></code> 以上の値、または <code class="docutils literal notranslate"><span class="pre">0.0000000001</span></code> 以下の値の時、指数の書式 <code class="docutils literal notranslate"><span class="pre">0.#####E-0</span></code> となります。
ただし、Excelのセルの幅が小さいと、表示される有効桁数が自動的に変わります。</p>
<p>さらに、それ以外の値の場合は、整数部の桁数によって、小数部の精度が変わります。
整数部の桁数が10桁以上のときは小数部はなく、整数部が10桁未満の場合は小数部が1桁づつ増えます。
例えば、 <code class="docutils literal notranslate"><span class="pre">12345678.12345</span></code> の場合、書式は <code class="docutils literal notranslate"><span class="pre">0.##</span></code> となります。</p>
<table border="1" class="colwidths-given docutils" id="id10">
<caption><span class="caption-text">数値の標準書式の表示例</span><a class="headerlink" href="#id10" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">値</th>
<th class="head">Excel上の表記</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>100000000000</td>
<td>1E+11</td>
</tr>
<tr class="row-odd"><td>99999999999</td>
<td>99999999999</td>
</tr>
<tr class="row-even"><td>12345678901234</td>
<td>1.23457E+13</td>
</tr>
<tr class="row-odd"><td>0.0000000001</td>
<td>1E-10</td>
</tr>
<tr class="row-even"><td>0.999999999</td>
<td>0.999999999</td>
</tr>
<tr class="row-odd"><td>0.000000000001234567</td>
<td>1.23457E-12</td>
</tr>
<tr class="row-even"><td>1234567890.12345</td>
<td>1234567890</td>
</tr>
<tr class="row-odd"><td>123456789.12345</td>
<td>123456789.1</td>
</tr>
<tr class="row-even"><td>12345678.12345</td>
<td>12345678.12</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id2">
<h2>5.2. ファイル内部の日付の基準日の設定<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelは、日付情報をファイル内部では数値型として値を保持しており、値が0の場合は基準日として、通常は <strong>「1899年12月31日（Excel表記上は1900年1月0日）」</strong> を表します。</p>
<p>この基準日は、設定によって変更することができ、ファイルごとに設定を持ちます。</p>
<ul class="simple">
<li><a class="reference external" href="https://support.microsoft.com/ja-jp/kb/180162/ja">Miscrosoftのサポートページ</a></li>
</ul>
<div class="section" id="excel1904">
<h3>5.2.1. Excelの1904年始まりの設定変更方法<a class="headerlink" href="#excel1904" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Excelのバージョンによって設定方法は変わります。</p>
<ul class="simple">
<li>Excel2000～2003の場合、メニュー「ツール」-「オプション」から表示されるダイアログ中のタブ「計算方法」から設定できます。</li>
<li>Excel2007の場合、Officeボタンの「オプション」から表示されるダイアログ中のペイン「詳細設定」から設定できます。</li>
<li>Excel2010の場合、メニュー「ファイル」の「オプション」から表示されるダイアログ中のペイン「詳細設定」から設定できます。</li>
<li>LibreOfficeの場合、メニュー「ツール」-「オプション」から表示されるダイアログ中のペイン「LibreOffice Calc」-「計算式」から設定できます。</li>
</ul>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_2002.png"><img alt="_images/excel_settings_date1904_2002.png" src="_images/excel_settings_date1904_2002.png" style="width: 460.5px; height: 286.0px;" /></a>
<p class="caption"><span class="caption-text">Excel2002(XP)の場合の1904年始まりの設定</span></p>
</div>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_2010.png"><img alt="_images/excel_settings_date1904_2010.png" src="_images/excel_settings_date1904_2010.png" style="width: 428.0px; height: 182.0px;" /></a>
<p class="caption"><span class="caption-text">Excel2010の場合の1904年始まりの設定</span></p>
</div>
<div class="figure align-center" id="id13">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_libre.png"><img alt="_images/excel_settings_date1904_libre.png" src="_images/excel_settings_date1904_libre.png" style="width: 565.0px; height: 233.0px;" /></a>
<p class="caption"><span class="caption-text">LibreOfficeの場合の1904年始まりの設定</span></p>
</div>
</div>
<div class="section" id="id3">
<h3>5.2.2. ライブラリによる1904年始まりの判定方法<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="apache-poi1904">
<h4>5.2.2.1. Apache POIにおける1904年始まりの判定方法<a class="headerlink" href="#apache-poi1904" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Apache POIの場合、ファイルのフォーマットによって取得方法が変わります。</p>
<ul class="simple">
<li>公開されていないメソッドなのでリフレクションを使用して取得します。</li>
<li>本ライブラリでは、 <em>POICell#isDateStart1904()</em> 中のメソッドで実装されています。</li>
<li>1904年始まりかどうかの設定はファイル単位に持つため、Workbookを取得して判定を行います。</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">final</span> <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getSheet</span><span class="o">().</span><span class="na">getWorkbook</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">HSSFWorkbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 拡張子がxlsの場合</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">HSSFWorkbook</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">&quot;getWorkbook&quot;</span><span class="o">);</span>
        <span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="n">InternalWorkbook</span> <span class="n">iw</span> <span class="o">=</span> <span class="o">(</span><span class="n">InternalWorkbook</span><span class="o">)</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">iw</span><span class="o">.</span><span class="na">isUsing1904DateWindowing</span><span class="o">();</span>

    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access method HSSFWorkbook.getWorkbook.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IllegalAccessException</span> <span class="o">|</span> <span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">InvocationTargetException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke method HSSFWorkbook.getWorkbook.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">XSSFWorkbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 拡張子がxlsxの場合</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">XSSFWorkbook</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">&quot;isDate1904&quot;</span><span class="o">);</span>
        <span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="o">(</span><span class="kt">boolean</span><span class="o">)</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access method XSSFWorkbook.isDate1904.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IllegalAccessException</span> <span class="o">|</span> <span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">InvocationTargetException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke method XSSFWorkbook.isDate1904.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="jexcelapi1904">
<h4>5.2.2.2. JExcelAPIにおける1904年始まりの判定方法<a class="headerlink" href="#jexcelapi1904" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>JExcel APIの場合も同様にWorkbookから取得しますが、セルクラスから上位のSheetクラスなどを取得できないため不便です。</p>
<ul class="simple">
<li>公開されていないメソッドなのでリフレクションを使用して取得します。</li>
<li>本ライブラリでは、 <em>JXLUtils#isDateStart1904(...)</em> 中のメソッドで実装されています。</li>
<li>1904年始まりかどうかの設定はシートにも引き継がれるため、Sheet、Wookbookのどちらからも判定できます。</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Workbookを元に判定を行う場合</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isDateStart1904</span><span class="o">(</span><span class="kd">final</span> <span class="n">Workbook</span> <span class="n">workbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArgUtils</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">workbook</span><span class="o">,</span> <span class="s">&quot;workbook&quot;</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">WorkbookParser</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">WorkbookParser</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&quot;nineteenFour&quot;</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access field WrokbookParser#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke field WrokbookParser#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// Sheetを元に判定を行う場合</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isDateStart1904</span><span class="o">(</span><span class="kd">final</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArgUtils</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="s">&quot;sheet&quot;</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span><span class="n">sheet</span> <span class="k">instanceof</span> <span class="n">SheetImpl</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">SheetImpl</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&quot;nineteenFour&quot;</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">sheet</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access field SheetImpl#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke field SheetImpl#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>5.2.3. 日時の内部表現<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Excelの場合、日時ファイル内部では数値として値を保持し、次の仕様となっています。</p>
<ul class="simple">
<li>整数部が日付情報。<ul>
<li>1日は、値は1.0。</li>
</ul>
</li>
<li>小数部が時刻情報。<ul>
<li>1秒は、 <code class="docutils literal notranslate"><span class="pre">1/(24*60*60)≒1.15741e-5</span></code> 。</li>
<li>Excelは、秒までの精度しか持たない。</li>
</ul>
</li>
<li>タイムゾーンは持たない。<ul>
<li>タイムゾーンは持たないため、OSの言語環境など変わっても、表示される時間は変わりません。</li>
</ul>
</li>
<li>基準日の値は、 <code class="docutils literal notranslate"><span class="pre">0.0</span></code> となる。<ul>
<li>ファイルの基準日の設定により、値が <code class="docutils literal notranslate"><span class="pre">0.0</span></code> のとき、1900年1月0日始まりか1904年1月1日始まりか変わります。</li>
</ul>
</li>
<li>内部的な値が負の数とる基準日より前の日時は表現できない。</li>
<li>1900年始まりの場合、他のオフィスアプリと互換性を持たすために、以下の不良のような仕様を引き継いでる。<ul>
<li>1900年1月0日から始まる。</li>
<li>グレゴリオ歴上は閏年でないのに、1900年2月29日が存在する。</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>グレゴリオ歴の閏年の定義</p>
<p><a class="reference external" href="https://ja.wikipedia.org/wiki/%E9%96%8F%E5%B9%B4">グレゴリオ暦</a> では、次の規則に従って400年間に（100回ではなく）97回の閏年を設ける。</p>
<ol class="last arabic simple">
<li>西暦年が4で割り切れる年は閏年。</li>
<li>ただし、西暦年が100で割り切れる年は平年（閏年でない）。</li>
<li>ただし、西暦年が400で割り切れる年は閏年。</li>
</ol>
</div>
<table border="1" class="colwidths-given docutils" id="id14">
<caption><span class="caption-text">Excelの日付の内部表現</span><a class="headerlink" href="#id14" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="25%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Excel表記上の日時</th>
<th class="head"><div class="first last line-block">
<div class="line">数値表現</div>
<div class="line">1900年始まり</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">数値表現</div>
<div class="line">1904年始まり</div>
</div>
</th>
<th class="head">備考</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1900年01月00日 00時00分00秒</td>
<td>0.00000000000</td>
<td>&#160;</td>
<td>1900年始まりの基準日。</td>
</tr>
<tr class="row-odd"><td>1900年01月01日 00時00分00秒</td>
<td>1.00000000000</td>
<td>&#160;</td>
<td>基準日から1日進む。</td>
</tr>
<tr class="row-even"><td>1900年02月29日 00時00分00秒</td>
<td>60.00000000000</td>
<td>&#160;</td>
<td>正しくない閏日。</td>
</tr>
<tr class="row-odd"><td>1900年03月01日 00時00分00秒</td>
<td>61.00000000000</td>
<td>&#160;</td>
<td>正しくない閏日の翌日。</td>
</tr>
<tr class="row-even"><td>1904年01月01日 00時00分00秒</td>
<td>1462.00000000000</td>
<td>0.00000000000</td>
<td>1904年始まりの基準日。</td>
</tr>
<tr class="row-odd"><td>1970年01月01日 00時00分00秒</td>
<td>25569.00000000000</td>
<td>24107.00000000000</td>
<td>UTCの基準日。</td>
</tr>
<tr class="row-even"><td>YYYY年MM月DD日 00時00分01秒</td>
<td>0.0000115741</td>
<td>0.0000115741</td>
<td>基準日から1秒経過</td>
</tr>
<tr class="row-odd"><td>YYYY年MM月DD日 00時01分00秒</td>
<td>0.00069444444444</td>
<td>0.00069444444444</td>
<td>基準日から1分経過</td>
</tr>
<tr class="row-even"><td>YYYY年MM月DD日 00時01分00秒</td>
<td>0.04166666666667</td>
<td>0.04166666666667</td>
<td>基準日から1時間経過</td>
</tr>
<tr class="row-odd"><td>YYYY年MM月DD日 23時59分59秒</td>
<td>0.99998842592593</td>
<td>0.99998842592593</td>
<td>基準日から23時間59分59秒経過</td>
</tr>
</tbody>
</table>
<div class="section" id="excelutc">
<h4>5.2.3.1. Excel上の日時の値をUTC表記に変換する方法<a class="headerlink" href="#excelutc" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Excelは日時は内部では数値で保持しており、Javaの <code class="docutils literal notranslate"><span class="pre">java.util.Date</span></code> に渡す形式であるUTC表現とは異なります。
また、基準日が複数あるため、UTC形式に変換するには次の計算を行う。</p>
<ol class="arabic simple">
<li>1904年始まりの場合。</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>24107の値を足す。(1970年1月1日から見て、1904年1月1日の経過日数を足す。)</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>1900年始まりの場合。</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>値が61.0以上ならば、1.0を引く。(1900年2月29日はUTC上存在しないため、1900年3月1日（=61.0）以降は、1日多くなるので調整する。)</li>
<li>25568.0の値を足す。(1970年1月1日から見て、1900年1月0日(=1899年12月31日)の経過日数を足す。)</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>値に24*60*60*1000を掛ける。(Excelは時刻が小数部なので、24*60*60で整数1桁目の精度を秒にする。UTCはミリ秒精度なので、さらに1000を掛ける。)</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>Excelの日時をUTCに返還する際の注意事項</p>
<ul class="last simple">
<li>本ライブラリでは、 <code class="docutils literal notranslate"><span class="pre">ExcelDateUtils#convertJavaDate(...)</span></code> メソッドで提供されています。</li>
<li>1900年始まりの場合、1900年1月0日は、1899年12月31日と表現します。</li>
<li>1900年始まりの場合、1900年2月29日は、1900年3月1日と表現します。、</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>5.3. ビルトインフォーマット（組み込み書式）について<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelの書式は、ファイル内部では <em>インデックス番号</em> に対して、 <em>書式のパターン</em> が割り振られています。</p>
<p>その中で、インデックス番号が 0～49は予め固定のフォーマットを持ち、ビルトインフォーマット（組み込み書式）と呼ばれます。</p>
<ul class="simple">
<li>Excelのバージョンによっては、インデックス番号だけ持ち、書式を持たない場合があります。</li>
<li>50番以降は、ユーザ定義用書式として、ファイルによって異なります。</li>
<li>ただし、50～59番は、Excelの言語環境によって予約された番号で、インデックス番号だけ持ち、書式を持たない場合があります。</li>
<li>ビルインフォーマットは、JExcelAPIの場合とApaceh POIでは一部異なっています。</li>
<li>OSの言語環境によって変わるものがあります。<ul>
<li>日時、通貨記号を含む書式は、環境によって変わる可能性があります。</li>
<li>JExcelAPI/Apache POIとも英語環境の値で固定で定義されており、日本語の書式には対応していません。</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>ビルトインフォーマットは、各ライブラリでプログラムで固定長の文字列として記述されています。</p>
<ul class="last simple">
<li>Apache POIの場合、 <code class="docutils literal notranslate"><span class="pre">org.apache.poi.ss.usermodel.BuiltinFormats</span></code> (<a class="reference external" href="https://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/BuiltinFormats.html">Javadoc</a> ) で定義されています。</li>
<li>JExcel APIの場合、 非公開のクラス <code class="docutils literal notranslate"><span class="pre">jxl.biff.BuiltInFormat</span></code> で定義されています。</li>
</ul>
</div>
<p>本ライブラリでは、OSの言語によって変わるような書式や間違っている書式は、
予め <code class="docutils literal notranslate"><span class="pre">FormatterResolver#registerDefaultFormat()</span></code> メソッド内で登録し、正しい書式で取得できるようにしています。</p>
<table border="1" class="colwidths-given docutils" id="id15">
<caption><span class="caption-text">ビルドインフォーマットの一覧（0～49）</span><a class="headerlink" href="#id15" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="25%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">16進</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">10進</div>
</div>
</th>
<th class="head">英語環境</th>
<th class="head"><div class="first last line-block">
<div class="line">日本語環境</div>
<div class="line">(英語環境と同じ場合は省略)</div>
</div>
</th>
<th class="head">例</th>
<th class="head">備考</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td><code class="docutils literal notranslate"><span class="pre">General</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">標準/G</span></code></td>
<td>&#160;</td>
<td>標準の設定。日本語の場合、内部的には英語環境と同じ。</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">-123</span></code></td>
<td>小数なしの数値の書式。</td>
</tr>
<tr class="row-even"><td>2</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">-123.45</span></code></td>
<td>小数ありの数値の書式。</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>3</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">-12,345</span></code></td>
<td>桁区切りの数値の書式。</td>
</tr>
<tr class="row-even"><td>4</td>
<td>4</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">-12,345.67</span></code></td>
<td>小数あり、桁区切りの数値の書式。</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>5</td>
<td><code class="docutils literal notranslate"><span class="pre">$#,##0_);($#,##0)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\#,##0;\-#,##0</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\-123</span></code></td>
<td>会計用の書式。通貨の単位や括弧が異なる。</td>
</tr>
<tr class="row-even"><td>6</td>
<td>6</td>
<td><code class="docutils literal notranslate"><span class="pre">$#,##0_);[Red]($#,##0)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\#,##0;[Red]\-#,##0</span></code></td>
<td>-123</td>
<td>会計用の書式。通貨の単位や括弧が異なる。</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>7</td>
<td><code class="docutils literal notranslate"><span class="pre">$#,##0.00);($#,##0.00)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\#,##0.00;\-#,##0.00</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\-123.46</span></code></td>
<td>会計用の書式。通貨の単位や括弧が異なる。</td>
</tr>
<tr class="row-even"><td>8</td>
<td>8</td>
<td><code class="docutils literal notranslate"><span class="pre">$#,##0.00_);[Red]($#,##0.00)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\#,##0.00;[Red]\-#,##0.00</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\-123.46</span></code></td>
<td>会計用の書式。通貨の単位や括弧が異なる。</td>
</tr>
<tr class="row-odd"><td>9</td>
<td>9</td>
<td><code class="docutils literal notranslate"><span class="pre">0%</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">12%</span></code></td>
<td>100分率の書式。</td>
</tr>
<tr class="row-even"><td>a</td>
<td>10</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00%</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">12.34%</span></code></td>
<td>100分率の書式。</td>
</tr>
<tr class="row-odd"><td>b</td>
<td>11</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00E+00</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">1.23E-02</span></code></td>
<td>指数用の書式。</td>
</tr>
<tr class="row-even"><td>c</td>
<td>12</td>
<td><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">?/?</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">12</span> <span class="pre">1/3</span></code></td>
<td>分数の書式。</td>
</tr>
<tr class="row-odd"><td>d</td>
<td>13</td>
<td><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">??/??</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">12</span> <span class="pre">10/29</span></code></td>
<td>分数の書式。</td>
</tr>
<tr class="row-even"><td>e</td>
<td>14</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy/m/d</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000/2/29</span></code></td>
<td>日付の書式。年の桁数、順番が異なる。</td>
</tr>
<tr class="row-odd"><td>f</td>
<td>15</td>
<td><code class="docutils literal notranslate"><span class="pre">d-mmm-yy</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">29-Feb-00</span></code></td>
<td>日付の書式。</td>
</tr>
<tr class="row-even"><td>10</td>
<td>16</td>
<td><code class="docutils literal notranslate"><span class="pre">d-mmm</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">29-Feb</span></code></td>
<td>日付の書式。</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>17</td>
<td><code class="docutils literal notranslate"><span class="pre">mmm-yy</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">Feb-00</span></code></td>
<td>日付の書式。</td>
</tr>
<tr class="row-even"><td>12</td>
<td>18</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm</span> <span class="pre">AM/PM</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19</span> <span class="pre">AM</span></code></td>
<td>時刻の書式。</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>19</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span> <span class="pre">AM/PM</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19:23</span> <span class="pre">AM</span></code></td>
<td>時刻の書式。</td>
</tr>
<tr class="row-even"><td>14</td>
<td>20</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19</span></code></td>
<td>時刻の書式。</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>21</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19:23</span></code></td>
<td>時刻の書式。</td>
</tr>
<tr class="row-even"><td>16</td>
<td>22</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span> <span class="pre">h:mm</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy/m/d</span> <span class="pre">h:mm</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000/2/29</span> <span class="pre">10:19</span></code></td>
<td>日時の書式。年の桁数、順番が異なる。</td>
</tr>
<tr class="row-odd"><td>17</td>
<td>23</td>
<td><code class="docutils literal notranslate"><span class="pre">\$#,##0_);\(\$#,##0\)</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">$36,585</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>18</td>
<td>24</td>
<td><code class="docutils literal notranslate"><span class="pre">\$#,##0_);[Red]\(\$#,##0\)</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">$36,585</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>19</td>
<td>25</td>
<td><code class="docutils literal notranslate"><span class="pre">\$#,##0.00_);\(\$#,##0.00\)</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">$36,585.43</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>1a</td>
<td>26</td>
<td><code class="docutils literal notranslate"><span class="pre">\$#,##0.00_);[Red]\(\$#,##0.00\)</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">$36,585.43</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>1b</td>
<td>27</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ge.m.d</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">H12.2.29</span></code></td>
<td><div class="first last line-block">
<div class="line">日付の書式。日本語環境の場合、和暦表示。</div>
<div class="line">ファイルを際保存すると、57番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>1c</td>
<td>28</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ggge&quot;年&quot;m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">平成12年2月29日</span></code></td>
<td><div class="first last line-block">
<div class="line">日付の書式。日本語環境の場合、和暦表示。</div>
<div class="line">ファイルを際保存すると、58番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>1d</td>
<td>29</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ggge&quot;年&quot;m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">平成12年2月29日</span></code></td>
<td><div class="first last line-block">
<div class="line">日付の書式。日本語環境の場合、和暦表示。</div>
<div class="line">ファイルを際保存すると、58番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>1e</td>
<td>30</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">2/29/00</span></code></td>
<td>日付の書式。</td>
</tr>
<tr class="row-odd"><td>1f</td>
<td>31</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy&quot;年&quot;m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000年2月29日</span></code></td>
<td>日付の書式。日本語環境の場合、和暦表示。</td>
</tr>
<tr class="row-even"><td>20</td>
<td>32</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">h&quot;時&quot;mm&quot;分&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">10時19分</span></code></td>
<td>時間の書式。日本語環境の場合、区切りが異なる。</td>
</tr>
<tr class="row-odd"><td>21</td>
<td>33</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">h&quot;時&quot;mm&quot;分&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">10時19分</span></code></td>
<td>時間の書式。日本語環境の場合、区切りが異なる。</td>
</tr>
<tr class="row-even"><td>22</td>
<td>34</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy&quot;年&quot;m&quot;月&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000年2月</span></code></td>
<td><div class="first last line-block">
<div class="line">時刻の書式。日本語環境の場合、日付の書式。</div>
<div class="line">ファイルを際保存すると、55番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>23</td>
<td>35</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2月29日</span></code></td>
<td><div class="first last line-block">
<div class="line">時刻の書式。日本語環境の場合、日付の書式。</div>
<div class="line">ファイルを際保存すると、56番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>24</td>
<td>36</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ge.m.d</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">H12.2.29</span></code></td>
<td><div class="first last line-block">
<div class="line">時刻の書式。日本語環境の場合、和暦表示。</div>
<div class="line">ファイルを際保存すると、57番に割り振られる。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>25</td>
<td>37</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0_);(#,##0)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0;-#,##0</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-even"><td>26</td>
<td>38</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0_);[Red](#,##0)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0;[Red]-#,##0</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-odd"><td>27</td>
<td>39</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00_);(#,##0.00)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00;-#,##0.00</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123.46</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-even"><td>28</td>
<td>40</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00_);[Red](#,##0.00)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00;[Red]-#,##0.00</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123.46</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-odd"><td>29</td>
<td>41</td>
<td><code class="docutils literal notranslate"><span class="pre">_(*</span> <span class="pre">#,##0_);_(*</span> <span class="pre">(#,##0);_(*</span> <span class="pre">&quot;-&quot;_);_(&#64;_)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">*</span> <span class="pre">#,##0_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">-#,##0_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">&quot;-&quot;_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-even"><td>2a</td>
<td>42</td>
<td><code class="docutils literal notranslate"><span class="pre">_($*</span> <span class="pre">#,##0_);_($*</span> <span class="pre">(#,##0);_($*</span> <span class="pre">&quot;-&quot;_);_(&#64;_)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">\*</span> <span class="pre">#,##0_</span> <span class="pre">;_</span> <span class="pre">\*</span> <span class="pre">-#,##0_</span> <span class="pre">;_</span> <span class="pre">\*</span> <span class="pre">&quot;-&quot;_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\-123</span></code></td>
<td>会計の書式。通貨が異なる。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-odd"><td>2b</td>
<td>43</td>
<td><code class="docutils literal notranslate"><span class="pre">_(*</span> <span class="pre">#,##0.00_);_(*</span> <span class="pre">(#,##0.00);_(*</span> <span class="pre">&quot;-&quot;??_);_(&#64;_)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">*</span> <span class="pre">#,##0.00_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">-#,##0.00_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">&quot;-&quot;??_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">-123.46</span></code></td>
<td>数値の書式。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-even"><td>2c</td>
<td>44</td>
<td><code class="docutils literal notranslate"><span class="pre">_($*</span> <span class="pre">#,##0.00_);_($*</span> <span class="pre">(#,##0.00);_($*</span> <span class="pre">&quot;-&quot;??_);_(&#64;_)</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">\*</span> <span class="pre">#,##0.00_</span> <span class="pre">;_</span> <span class="pre">\*</span> <span class="pre">-#,##0.00_</span> <span class="pre">;_</span> <span class="pre">\*</span> <span class="pre">&quot;-&quot;??_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">\-123.46</span></code></td>
<td>会計の書式。通貨が異なる。日本語の場合、負の表現に括弧が付かない。</td>
</tr>
<tr class="row-odd"><td>2d</td>
<td>45</td>
<td><code class="docutils literal notranslate"><span class="pre">mm:ss</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19</span></code></td>
<td>時刻の書式。</td>
</tr>
<tr class="row-even"><td>2e</td>
<td>46</td>
<td><code class="docutils literal notranslate"><span class="pre">[h]:mm:ss</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">30:10:19</span></code></td>
<td>時間時間の書式。</td>
</tr>
<tr class="row-odd"><td>2f</td>
<td>47</td>
<td><code class="docutils literal notranslate"><span class="pre">mm:ss.0</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">10:19.0</span></code></td>
<td>時間の書式。</td>
</tr>
<tr class="row-even"><td>30</td>
<td>48</td>
<td><code class="docutils literal notranslate"><span class="pre">##0.0E+0</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">12.3E+0</span></code></td>
<td>指数の書式。</td>
</tr>
<tr class="row-odd"><td>41</td>
<td>49</td>
<td><code class="docutils literal notranslate"><span class="pre">&#64;</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">テキスト</span></code></td>
<td>文字列の書式。</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-given docutils" id="id16">
<caption><span class="caption-text">ビルドインフォーマットの一覧（50～）</span><a class="headerlink" href="#id16" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="25%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">16進</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">10進</div>
</div>
</th>
<th class="head">英語環境</th>
<th class="head"><div class="first last line-block">
<div class="line">日本語環境</div>
<div class="line">(英語環境と同じ場合は省略)</div>
</div>
</th>
<th class="head">例</th>
<th class="head">備考</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>37</td>
<td>55</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy&quot;年&quot;m&quot;月&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000年2月</span></code></td>
<td>時刻の書式。日本語の場合、日付の書式。</td>
</tr>
<tr class="row-odd"><td>38</td>
<td>56</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2月29日</span></code></td>
<td>時刻の書式。日本語の場合、日付の書式。</td>
</tr>
<tr class="row-even"><td>39</td>
<td>57</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ge.m.d</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">H12.2.29</span></code></td>
<td>日付の書式。日本語の場合、和暦表示。</td>
</tr>
<tr class="row-odd"><td>3A</td>
<td>58</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">[$-411]ggge&quot;年&quot;m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">平成12年2月29日</span></code></td>
<td>日付の書式。日本語の場合、和暦表示。</td>
</tr>
</tbody>
</table>
<p>組み込み書式以外で、OSの言語環境によって変わる書式があります。
Excel上では、書式の前にアスタリスク（*）が付いている書式です。</p>
<table border="1" class="colwidths-given docutils" id="id17">
<caption><span class="caption-text">言語によって書式が変わる</span><a class="headerlink" href="#id17" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">英語環境</th>
<th class="head">日本の語環境</th>
<th class="head">例</th>
<th class="head">備考</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy/m/d</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000/2/29</span></code></td>
<td><div class="first last line-block">
<div class="line">日付の書式。Excelの表記上は、「* 2001/3/14」と表示されます。</div>
<div class="line">インデックス番号14の組み込み書式です。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">[$-F800]dddd\,\</span> <span class="pre">mmmm\</span> <span class="pre">dd\,\</span> <span class="pre">yyyy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">yyyy&quot;年&quot;m&quot;月&quot;d&quot;日&quot;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2000年2月29日</span></code></td>
<td>日付の書式。Excelの表記上は、「* 2001年3月14日」と表示されます。</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">[$-F400]h:mm:ss\</span> <span class="pre">AM/PM</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">10:19:23</span></code></td>
<td>日付の書式。Excelの表記上は、「* 13:30:55」と表示されます。</td>
</tr>
</tbody>
</table>
<div class="section" id="jexcelapi">
<h3>5.3.1. JExcelAPIによる書式のインデックスの取得<a class="headerlink" href="#jexcelapi" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>JExcelAPIでは、書式のインデックスの取得は <code class="docutils literal notranslate"><span class="pre">DisplayFormat#getFormatIndex()</span></code> から取得します。</li>
<li>ビルトインフォーマットの定義は、非公開のクラス <code class="docutils literal notranslate"><span class="pre">jxl.biff.BuiltInfFomrat</span></code> で定義されています。</li>
<li>本ライブラリでは、 <code class="docutils literal notranslate"><span class="pre">JXLCell#getFormatIndex()</span></code> で実装されている。</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">final</span> <span class="n">CellFormat</span> <span class="n">cellStyle</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getCellFormat</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">cellStyle</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 書式を持たない場合</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="n">Format</span> <span class="n">cellFormat</span> <span class="o">=</span> <span class="n">cellStyle</span><span class="o">.</span><span class="na">getFormat</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">cellStyle</span> <span class="k">instanceof</span> <span class="n">XFRecord</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">XFRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="o">(</span><span class="n">XFRecord</span><span class="o">)</span> <span class="n">cellStyle</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="n">record</span><span class="o">.</span><span class="na">formatIndex</span><span class="o">;</span>

<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 書式を持たない場合</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="k">instanceof</span> <span class="n">DisplayFormat</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">DisplayFormat</span> <span class="n">displayFormat</span> <span class="o">=</span> <span class="o">(</span><span class="n">DisplayFormat</span><span class="o">)</span><span class="n">cellFormat</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="n">displayFormat</span><span class="o">.</span><span class="na">getFormatIndex</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// 不明な場合</span>
<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="apache-poi">
<h3>5.3.2. Apache POIによる書式のインデックスの取得<a class="headerlink" href="#apache-poi" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>Apache POIの書式のインデックスは、 <code class="docutils literal notranslate"><span class="pre">CellSyle#getDataFormat()</span></code> から取得します。</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">short</span> <span class="n">formatIndex</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getCellStyle</span><span class="o">().</span><span class="na">getDataFormat</span><span class="o">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>5.4. エラーのセルについて<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelの計算結果などによって、エラー値が表示されます。</p>
<p>エラー値は数種類あり、ライブラリではコード値から判断します。</p>
<table border="1" class="colwidths-given docutils" id="id18">
<caption><span class="caption-text">Excelのエラー値の一覧</span><a class="headerlink" href="#id18" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">エラーコード</div>
<div class="line">（10進数）</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">エラーコード</div>
<div class="line">（16進数）</div>
</div>
</th>
<th class="head">表示</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td><code class="docutils literal notranslate"><span class="pre">#NULL!</span></code></td>
<td><div class="first last line-block">
<div class="line">正しくない参照演算子または正しくないセル参照を使っている場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=SUM(A1:A3</span> <span class="pre">C1:C3)</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>7</td>
<td><code class="docutils literal notranslate"><span class="pre">#DIV/0!</span></code></td>
<td><div class="first last line-block">
<div class="line">数式や関数が0（ゼロ）または空白のセルで割られている場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=200/0</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td>15</td>
<td>15</td>
<td><code class="docutils literal notranslate"><span class="pre">#VALUE!</span></code></td>
<td><div class="first last line-block">
<div class="line">関数の引数の形式が間違っている場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=MAX(&quot;Dekiru&quot;)</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>23</td>
<td>17</td>
<td><code class="docutils literal notranslate"><span class="pre">#REF!</span></code></td>
<td><div class="first last line-block">
<div class="line">数式内で無効なセルが参照されている</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=INT(A1)</span></code> とセルA1を移動または削除してしまった場合に表示されます。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>29</td>
<td>1d</td>
<td><code class="docutils literal notranslate"><span class="pre">#NAME?</span></code></td>
<td><div class="first last line-block">
<div class="line">Excelの関数では利用できない名前が使用されている場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=HEIKIN(A1:C1)</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>36</td>
<td>24</td>
<td><code class="docutils literal notranslate"><span class="pre">#NUM!</span></code></td>
<td><div class="first last line-block">
<div class="line">数式または関数の数値が不適切な場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=SMALL(A1:A3,C1)</span></code> と入力して第2引数の値を数値以外のセルを指定した場合に表示されます。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>42</td>
<td>2a</td>
<td><code class="docutils literal notranslate"><span class="pre">#N/A</span></code></td>
<td><div class="first last line-block">
<div class="line">計算や処理の対象となるデータがない、または正当な結果が得られない場合に表示されます。</div>
<div class="line">例 <code class="docutils literal notranslate"><span class="pre">=MODE(10,20,30,40)</span></code></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>Apache POIでエラー値を取得する場合の注意事項。</p>
<p>POIでエラー値が正しく取得できない場合があります。</p>
<ol class="last arabic simple">
<li>ファイルの形式がxls(HSSF)の場合、全て「#VALUE!」となります。ただし、ファイルの形式がxlsx(XSSF)だと各種類が取得できます。<ul>
<li>xlsx(XSSF)形式の場合でも場合によっては異なるコード値となります。</li>
</ul>
</li>
<li>関数「=DATE(50000,1,1)」はExcelでは「#NUM!」と表示され計算できないが、POIの場合は正常に計算ができます。<ul>
<li>これは、Javaの日付の表示範囲がExcelよりも広いため。</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section" id="id-lcid">
<h2>5.5. ロケールID(LCID)の一覧<a class="headerlink" href="#id-lcid" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelで指定可能なロケールの一覧は、外部サイトの <a class="reference external" href="https://msdn.microsoft.com/ja-jp/library/cc392381.aspx">ロケール ID (LCID) の一覧</a> で確認できます。</p>
<p>Excelの書式で指定する際には、16進数表記の値で指定します。</p>
<p>日本語の場合、LCIDは0x0411であるため、書式上では <code class="docutils literal notranslate"><span class="pre">[$-411]</span></code> と指定します。</p>
<table border="1" class="colwidths-given docutils" id="id19">
<caption><span class="caption-text">LCIDの一覧</span><a class="headerlink" href="#id19" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="20%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ロケール名</th>
<th class="head">言語コード</th>
<th class="head">16進値</th>
<th class="head">10進数</th>
<th class="head">ロケール名</th>
<th class="head">言語コード</th>
<th class="head">16進値</th>
<th class="head">10進数</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>アフリカーンス語</td>
<td>af</td>
<td>0x0436</td>
<td>1078</td>
<td>ヒンズー語</td>
<td>hi</td>
<td>0x0439</td>
<td>1081</td>
</tr>
<tr class="row-odd"><td>アルバニア語</td>
<td>sq</td>
<td>0x041C</td>
<td>1052</td>
<td>ハンガリー語</td>
<td>hu</td>
<td>0x040E</td>
<td>1038</td>
</tr>
<tr class="row-even"><td>アラビア語 (U.A.E.)</td>
<td>ar-ae</td>
<td>0x3801</td>
<td>14337</td>
<td>アイスランド語</td>
<td>is</td>
<td>0x040F</td>
<td>1039</td>
</tr>
<tr class="row-odd"><td>アラビア語 (バーレーン)</td>
<td>ar-bh</td>
<td>0x3C01</td>
<td>15361</td>
<td>インドネシア語</td>
<td>in</td>
<td>0x0421</td>
<td>1057</td>
</tr>
<tr class="row-even"><td>アラビア語 (アルジェリア)</td>
<td>ar-dz</td>
<td>0x1401</td>
<td>5121</td>
<td>イタリア語 (イタリア)</td>
<td>it</td>
<td>0x0410</td>
<td>1040</td>
</tr>
<tr class="row-odd"><td>アラビア語 (エジプト)</td>
<td>ar-eg</td>
<td>0x0C01</td>
<td>3073</td>
<td>イタリア語 (スイス)</td>
<td>it-ch</td>
<td>0x0810</td>
<td>2064</td>
</tr>
<tr class="row-even"><td>アラビア語 (イラク)</td>
<td>ar-iq</td>
<td>0x0801</td>
<td>2049</td>
<td>日本語</td>
<td>ja</td>
<td>0x0411</td>
<td>1041</td>
</tr>
<tr class="row-odd"><td>アラビア語 (ヨルダン)</td>
<td>ar-jo</td>
<td>0x2C01</td>
<td>11265</td>
<td>韓国語</td>
<td>ko</td>
<td>0x0412</td>
<td>1042</td>
</tr>
<tr class="row-even"><td>アラビア語 (クウェート)</td>
<td>ar-kw</td>
<td>0x3401</td>
<td>13313</td>
<td>ラトビア語</td>
<td>lv</td>
<td>0x0426</td>
<td>1062</td>
</tr>
<tr class="row-odd"><td>アラビア語 (レバノン)</td>
<td>ar-lb</td>
<td>0x3001</td>
<td>12289</td>
<td>リトアニア語</td>
<td>lt</td>
<td>0x0427</td>
<td>1063</td>
</tr>
<tr class="row-even"><td>アラビア語 (リビア)</td>
<td>ar-ly</td>
<td>0x1001</td>
<td>4097</td>
<td>マケドニア語 (FYROM)</td>
<td>mk</td>
<td>0x042F</td>
<td>1071</td>
</tr>
<tr class="row-odd"><td>アラビア語 (モロッコ)</td>
<td>ar-ma</td>
<td>0x1801</td>
<td>6145</td>
<td>マレー語 (マレーシア)</td>
<td>ms</td>
<td>0x043E</td>
<td>1086</td>
</tr>
<tr class="row-even"><td>アラビア語 (オマーン)</td>
<td>ar-om</td>
<td>0x2001</td>
<td>8193</td>
<td>マルタ語</td>
<td>mt</td>
<td>0x043A</td>
<td>1082</td>
</tr>
<tr class="row-odd"><td>アラビア語 (カタール)</td>
<td>ar-qa</td>
<td>0x4001</td>
<td>16385</td>
<td>ノルウェー語 (ブークモール)</td>
<td>no</td>
<td>0x0414</td>
<td>1044</td>
</tr>
<tr class="row-even"><td>アラビア語 (サウジアラビア)</td>
<td>ar-sa</td>
<td>0x0401</td>
<td>1025</td>
<td>ポーランド語</td>
<td>pl</td>
<td>0x0415</td>
<td>1045</td>
</tr>
<tr class="row-odd"><td>アラビア語 (シリア)</td>
<td>ar-sy</td>
<td>0x2801</td>
<td>10241</td>
<td>ポルトガル語 (ポルトガル)</td>
<td>pt</td>
<td>0x0816</td>
<td>2070</td>
</tr>
<tr class="row-even"><td>アラビア語 (チュニジア)</td>
<td>ar-tn</td>
<td>0x1C01</td>
<td>7169</td>
<td>ポルトガル語 (ブラジル)</td>
<td>pt-br</td>
<td>0x0416</td>
<td>1046</td>
</tr>
<tr class="row-odd"><td>アラビア語 (イエメン)</td>
<td>ar-ye</td>
<td>0x2401</td>
<td>9217</td>
<td>レトロマン語</td>
<td>rm</td>
<td>0x0417</td>
<td>1047</td>
</tr>
<tr class="row-even"><td>バスク語</td>
<td>eu</td>
<td>0x042D</td>
<td>1069</td>
<td>ルーマニア語</td>
<td>ro</td>
<td>0x0418</td>
<td>1048</td>
</tr>
<tr class="row-odd"><td>ベラルーシ語</td>
<td>be</td>
<td>0x0423</td>
<td>1059</td>
<td>ルーマニア語 (モルドバ)</td>
<td>ro-mo</td>
<td>0x0818</td>
<td>2072</td>
</tr>
<tr class="row-even"><td>ブルガリア語</td>
<td>bg</td>
<td>0x0402</td>
<td>1026</td>
<td>ロシア語</td>
<td>ru</td>
<td>0x0419</td>
<td>1049</td>
</tr>
<tr class="row-odd"><td>カタロニア語</td>
<td>ca</td>
<td>0x0403</td>
<td>1027</td>
<td>ロシア語 (モルドバ)</td>
<td>ru-mo</td>
<td>0x0819</td>
<td>2073</td>
</tr>
<tr class="row-even"><td>中国語 (中華人民共和国)</td>
<td>zh-cn</td>
<td>0x0804</td>
<td>2052</td>
<td>セルビア語 (キリル文字)</td>
<td>sr</td>
<td>0x0C1A</td>
<td>3098</td>
</tr>
<tr class="row-odd"><td>中国語 (香港)</td>
<td>zh-hk</td>
<td>0x0C04</td>
<td>3076</td>
<td>ツワナ語</td>
<td>tn</td>
<td>0x0432</td>
<td>1074</td>
</tr>
<tr class="row-even"><td>中国語 (シンガポール)</td>
<td>zh-sg</td>
<td>0x1004</td>
<td>4100</td>
<td>スロベニア語</td>
<td>sl</td>
<td>0x0424</td>
<td>1060</td>
</tr>
<tr class="row-odd"><td>中国語 (台湾)</td>
<td>zh-tw</td>
<td>0x0404</td>
<td>1028</td>
<td>スロバキア語</td>
<td>sk</td>
<td>0x041B</td>
<td>1051</td>
</tr>
<tr class="row-even"><td>クロアチア語</td>
<td>hr</td>
<td>0x041A</td>
<td>1050</td>
<td>ソルビア語</td>
<td>sb</td>
<td>0x042E</td>
<td>1070</td>
</tr>
<tr class="row-odd"><td>チェコ語</td>
<td>cs</td>
<td>0x0405</td>
<td>1029</td>
<td>スペイン語 (スペイン)</td>
<td>es</td>
<td>0x040A</td>
<td>1034</td>
</tr>
<tr class="row-even"><td>デンマーク語</td>
<td>da</td>
<td>0x0406</td>
<td>1030</td>
<td>スペイン語 (アルゼンチン)</td>
<td>es-ar</td>
<td>0x2C0A</td>
<td>11274</td>
</tr>
<tr class="row-odd"><td>オランダ語</td>
<td>nl</td>
<td>0x0413</td>
<td>1043</td>
<td>スペイン語 (ボリビア)</td>
<td>es-bo</td>
<td>0x400A</td>
<td>16394</td>
</tr>
<tr class="row-even"><td>オランダ語 (ベルギー)</td>
<td>nl-be</td>
<td>0x0813</td>
<td>2067</td>
<td>スペイン語 (チリ)</td>
<td>es-cl</td>
<td>0x340A</td>
<td>13322</td>
</tr>
<tr class="row-odd"><td>英語 (オーストラリア)</td>
<td>en-au</td>
<td>0x0C09</td>
<td>3081</td>
<td>スペイン語 (コロンビア)</td>
<td>es-co</td>
<td>0x240A</td>
<td>9226</td>
</tr>
<tr class="row-even"><td>英語 (ベリーズ)</td>
<td>en-bz</td>
<td>0x2809</td>
<td>10249</td>
<td>スペイン語 (コスタリカ)</td>
<td>es-cr</td>
<td>0x140A</td>
<td>5130</td>
</tr>
<tr class="row-odd"><td>英語 (カナダ)</td>
<td>en-ca</td>
<td>0x1009</td>
<td>4105</td>
<td>スペイン語 (ドミニカ共和国)</td>
<td>es-do</td>
<td>0x1C0A</td>
<td>7178</td>
</tr>
<tr class="row-even"><td>英語 (アイルランド)</td>
<td>en-ie</td>
<td>0x1809</td>
<td>6153</td>
<td>スペイン語 (エクアドル)</td>
<td>es-ec</td>
<td>0x300A</td>
<td>12298</td>
</tr>
<tr class="row-odd"><td>英語 (ジャマイカ)</td>
<td>en-jm</td>
<td>0x2009</td>
<td>8201</td>
<td>スペイン語 (グアテマラ)</td>
<td>es-gt</td>
<td>0x100A</td>
<td>4106</td>
</tr>
<tr class="row-even"><td>英語 (ニュージーランド)</td>
<td>en-nz</td>
<td>0x1409</td>
<td>5129</td>
<td>スペイン語 (ホンジュラス)</td>
<td>es-hn</td>
<td>0x480A</td>
<td>18442</td>
</tr>
<tr class="row-odd"><td>英語 (南アフリカ)</td>
<td>en-za</td>
<td>0x1C09</td>
<td>7177</td>
<td>スペイン語 (メキシコ)</td>
<td>es-mx</td>
<td>0x080A</td>
<td>2058</td>
</tr>
<tr class="row-even"><td>英語 (トリニダード)</td>
<td>en-tt</td>
<td>0x2C09</td>
<td>11273</td>
<td>スペイン語 (ニカラグア)</td>
<td>es-ni</td>
<td>0x4C0A</td>
<td>19466</td>
</tr>
<tr class="row-odd"><td>英語 (U.K.)</td>
<td>en-gb</td>
<td>0x0809</td>
<td>2057</td>
<td>スペイン語 (パナマ)</td>
<td>es-pa</td>
<td>0x180A</td>
<td>6154</td>
</tr>
<tr class="row-even"><td>英語 (U.S.)</td>
<td>en-us</td>
<td>0x0409</td>
<td>1033</td>
<td>スペイン語 (ペルー)</td>
<td>es-pe</td>
<td>0x280A</td>
<td>10250</td>
</tr>
<tr class="row-odd"><td>エストニア語</td>
<td>et</td>
<td>0x0425</td>
<td>1061</td>
<td>スペイン語 (プエルトリコ)</td>
<td>es-pr</td>
<td>0x500A</td>
<td>20490</td>
</tr>
<tr class="row-even"><td>ペルシャ語</td>
<td>fa</td>
<td>0x0429</td>
<td>1065</td>
<td>スペイン語 (パラグアイ)</td>
<td>es-py</td>
<td>0x3C0A</td>
<td>15370</td>
</tr>
<tr class="row-odd"><td>フィンランド語</td>
<td>fi</td>
<td>0x040B</td>
<td>1035</td>
<td>スペイン語 (エルサルバドル)</td>
<td>es-sv</td>
<td>0x440A</td>
<td>17418</td>
</tr>
<tr class="row-even"><td>フェロー語</td>
<td>fo</td>
<td>0x0438</td>
<td>1080</td>
<td>スペイン語 (ウルグアイ)</td>
<td>es-uy</td>
<td>0x380A</td>
<td>14346</td>
</tr>
<tr class="row-odd"><td>フランス語 (フランス)</td>
<td>fr</td>
<td>0x040C</td>
<td>1036</td>
<td>スペイン語 (ベネズエラ)</td>
<td>es-ve</td>
<td>0x200A</td>
<td>8202</td>
</tr>
<tr class="row-even"><td>フランス語 (ベルギー)</td>
<td>fr-be</td>
<td>0x080C</td>
<td>2060</td>
<td>ソト語</td>
<td>sx</td>
<td>0x0430</td>
<td>1072</td>
</tr>
<tr class="row-odd"><td>フランス語 (カナダ)</td>
<td>fr-ca</td>
<td>0x0C0C</td>
<td>3084</td>
<td>スウェーデン語</td>
<td>sv</td>
<td>0x041D</td>
<td>1053</td>
</tr>
<tr class="row-even"><td>フランス語 (ルクセンブルグ)</td>
<td>fr-lu</td>
<td>0x140C</td>
<td>5132</td>
<td>スウェーデン語 (フィンランド)</td>
<td>sv-fi</td>
<td>0x081D</td>
<td>2077</td>
</tr>
<tr class="row-odd"><td>フランス語 (スイス)</td>
<td>fr-ch</td>
<td>0x100C</td>
<td>4108</td>
<td>タイ語</td>
<td>th</td>
<td>0x041E</td>
<td>1054</td>
</tr>
<tr class="row-even"><td>ゲール語 (スコットランド)</td>
<td>gd</td>
<td>0x043C</td>
<td>1084</td>
<td>トルコ語</td>
<td>tr</td>
<td>0x041F</td>
<td>1055</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (ドイツ)</td>
<td>de</td>
<td>0x0407</td>
<td>1031</td>
<td>ツォンガ語</td>
<td>ts</td>
<td>0x0431</td>
<td>1073</td>
</tr>
<tr class="row-even"><td>ドイツ語 (オーストリア)</td>
<td>de-at</td>
<td>0x0C07</td>
<td>3079</td>
<td>ウクライナ語</td>
<td>uk</td>
<td>0x0422</td>
<td>1058</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (リヒテンシュタイン)</td>
<td>de-li</td>
<td>0x1407</td>
<td>5127</td>
<td>ウルドゥー語 (パキスタン)</td>
<td>ur</td>
<td>0x0420</td>
<td>1056</td>
</tr>
<tr class="row-even"><td>ドイツ語 (ルクセンブルグ)</td>
<td>de-lu</td>
<td>0x1007</td>
<td>4103</td>
<td>ベトナム語</td>
<td>vi</td>
<td>0x042A</td>
<td>1066</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (スイス)</td>
<td>de-ch</td>
<td>0x0807</td>
<td>2055</td>
<td>コーサ語</td>
<td>xh</td>
<td>0x0434</td>
<td>1076</td>
</tr>
<tr class="row-even"><td>ギリシャ語</td>
<td>el</td>
<td>0x0408</td>
<td>1032</td>
<td>イディッシュ語</td>
<td>ji</td>
<td>0x043D</td>
<td>1085</td>
</tr>
<tr class="row-odd"><td>ヘブライ語</td>
<td>he</td>
<td>0x040D</td>
<td>1037</td>
<td>ズールー語</td>
<td>zu</td>
<td>0x0435</td>
<td>1077</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id9">
<h2>5.6. 漢数字／大字変換のアルゴリズム<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>漢数字や大字への変換は、下記のように行います。</p>
<ol class="arabic simple" start="0">
<li>値が0の時は、値を〇（ゼロ）として処理を終了。</li>
<li>下の桁から4桁ごとに分割する。</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>実装方式としては、数値形式の場合は、10,000で割っていった余りに対して処理する。</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>分割した内容を漢数字に変換する。</li>
</ol>
<blockquote>
<div><ol class="loweralpha">
<li><p class="first">0の場合は省略する。</p>
</li>
<li><div class="first line-block">
<div class="line">1の場合は、桁数におおじて数値を省略し、単位のみを付与する。</div>
<div class="line">例えば、1の位の場合は数値を省略しない。</div>
<div class="line">十の位は、「十」と数値を省略して単位を付与する。</div>
</div>
</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>分割した変換結果に、4桁区切りの単位を付けて、結合する。</li>
</ol>
<div class="figure align-center" id="id20">
<a class="reference internal image-reference" href="_images/convert_kansuji.png"><img alt="_images/convert_kansuji.png" src="_images/convert_kansuji.png" style="width: 929.5999999999999px; height: 492.79999999999995px;" /></a>
<p class="caption"><span class="caption-text">漢数字の変換の概要</span></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="release.html" title="6. リリースノート"
             >次へ</a> |</li>
        <li class="right" >
          <a href="format_basic.html" title="4. Excelの書式の基本について"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Excel-CellFormatter 0.11 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
<!-- my theme custom extrahead beacon -->
<script type="text/javascript" src="_static/jquery.externallink.js" charset="UTF-8"></script>
<script type="text/javascript">
	jQuery(function () {
		// コンテンツ用
		$('body').externalLink({cssClass : 'externalink', iconUrl:'', startUrl:'../apidocs/'});
		
	});
</script>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37313068-4', 'auto');
  ga('send', 'pageview');
  
</script>


    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2019, T.TSUCHIE.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9 で生成しました。
    </div>

  </body>
</html>